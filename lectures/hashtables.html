<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Class summary: Working with Hashtables</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Class summary:<span class="mywbr"> &nbsp;</span> Working with Hashtables</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.What_are_hashtables_and_when_do_we_use_them_%29" class="tocviewlink" data-pltdoc="x">What are hashtables and when do we use them?</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Hashtables_in_code%29" class="tocviewlink" data-pltdoc="x">Hashtables in code</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Converting_code_from_lists_to_hashtables%29" class="tocviewlink" data-pltdoc="x">Converting code from lists to hashtables</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._.The_global_annotation%29" class="tocviewlink" data-pltdoc="x">The global annotation</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Class_summary__.Working_with_.Hashtables%29" class="tocsubseclink" data-pltdoc="x">Class summary:<span class="mywbr"> &nbsp;</span> Working with Hashtables</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.What_are_hashtables_and_when_do_we_use_them_%29" class="tocsubseclink" data-pltdoc="x">What are hashtables and when do we use them?</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Hashtables_in_code%29" class="tocsubseclink" data-pltdoc="x">Hashtables in code</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Creating_from_.Scratch%29" class="tocsubseclink" data-pltdoc="x">Creating from Scratch</a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.Looking_up_.Values%29" class="tocsubseclink" data-pltdoc="x">Looking up Values</a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Updating_.Values%29" class="tocsubseclink" data-pltdoc="x">Updating Values</a></td></tr><tr><td><span class="tocsublinknumber">2.4<tt>&nbsp;</tt></span><a href="#%28part._.Adding_.New_.Keys%29" class="tocsubseclink" data-pltdoc="x">Adding New Keys</a></td></tr><tr><td><span class="tocsublinknumber">2.5<tt>&nbsp;</tt></span><a href="#%28part._.Removing_.Keys%29" class="tocsubseclink" data-pltdoc="x">Removing Keys</a></td></tr><tr><td><span class="tocsublinknumber">2.6<tt>&nbsp;</tt></span><a href="#%28part._.Checking_whether_a_key_is_in_the_table%29" class="tocsubseclink" data-pltdoc="x">Checking whether a key is in the table</a></td></tr><tr><td><span class="tocsublinknumber">2.7<tt>&nbsp;</tt></span><a href="#%28part._.Iterating_over_key-value_pairs%29" class="tocsubseclink" data-pltdoc="x">Iterating over key-<wbr></wbr>value pairs</a></td></tr><tr><td><span class="tocsublinknumber">2.8<tt>&nbsp;</tt></span><a href="#%28part._.Hashtables_with_more_complicated_values%29" class="tocsubseclink" data-pltdoc="x">Hashtables with more complicated values</a></td></tr><tr><td><span class="tocsublinknumber">2.9<tt>&nbsp;</tt></span><a href="#%28part._.Wrapup%29" class="tocsubseclink" data-pltdoc="x">Wrapup</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Converting_code_from_lists_to_hashtables%29" class="tocsubseclink" data-pltdoc="x">Converting code from lists to hashtables</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.The_global_annotation%29" class="tocsubseclink" data-pltdoc="x">The global annotation</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><h2><a name="(part._.Class_summary__.Working_with_.Hashtables)"></a>Class summary: Working with Hashtables</h2><p>Copyright (c) 2017 Kathi Fisler</p><p>Last lecture, we hinted that we could reduce the time to find a value
in a collection to constant time (instead of linear search through a
list), by leveraging knowledge about where data live in memory.  The
data structure that does this is called a <span style="font-style: italic">hashtable</span>. We gave
the intuition about how this works, but skimmed over details about how
this works in code, and how it works under the hood.</p><p>Today, we study hashtables at the level of code. Next lecture, we&rsquo;ll
look at how they work under the hood.</p><p>Hashtables are called <span style="font-style: italic">dictionaries</span> in Python. To avoid
terminology confusion with our use of the term dictionary (for mapping
names to memory locations and values), I&rsquo;ll continue to refer to them
as hashtables in notes.</p><h3>1<tt>&nbsp;</tt><a name="(part._.What_are_hashtables_and_when_do_we_use_them_)"></a>What are hashtables and when do we use them?</h3><p>A hashtable is a data structure designed for looking up values as
indexed by some notion of a key. Imagine that you had a two-column
table: the first column holds keys, and the second column holds the
value associated with each key.  For example, here&rsquo;s a table that has
Brown classrooms as keys, and their seating capacities as values.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Key</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">Value</span></p></td></tr><tr><td><p><span class="stt">--------------------</span></p></td></tr><tr><td><p><span class="stt">CIT368	</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">63</span></p></td></tr><tr><td><p><span class="stt">BERT130</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">200</span></p></td></tr><tr><td><p><span class="stt">FRDMN101</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">48</span></p></td></tr></table></p><p>This is the essential form of data that we can turn into a hashtable:
keys and values, with one value per key. In many languages, all of the
values need to be of the same type (which can be anything).  Python is
more forgiving, and would allow different types to be stored under
different keys.  The keys need to be of a common type, however &ndash; that
will be part of how hashtables work under the hood.</p><h3>2<tt>&nbsp;</tt><a name="(part._.Hashtables_in_code)"></a>Hashtables in code</h3><h4>2.1<tt>&nbsp;</tt><a name="(part._.Creating_from_.Scratch)"></a>Creating from Scratch</h4><p>Let&rsquo;s turn our two-column table from above into a proper
hashtable. Here&rsquo;s the general notation for creating a hashtable by
hand in Python:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">{key: value,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">key: value,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">key: value,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></table></p><p>The curly brackets say "hashtable". After that, we are writing down
pairs of keys and their corresponding values.</p><p>So our table above would be written as follows:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"># a hashtable mapping classrooms to numbers of seats</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">room_capacity = {"CIT368": 63,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"BERT130": 200,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"FRDMN101": 48</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></table></p><p>The type for hashtables in Python is <span style="font-style: italic">dict</span> (short for dictionary)</p><h4>2.2<tt>&nbsp;</tt><a name="(part._.Looking_up_.Values)"></a>Looking up Values</h4><p>The following notation looks up the value for <span style="font-style: italic">key</span> in
<span style="font-style: italic">hashtable</span>:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">hashtable[key]</span></p></td></tr></table></p><p>So, to get the number of seats in CIT368, we&rsquo;d write:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">room_capacity["CIT368"]</span></p></td></tr></table></p><p>If the key you request isn&rsquo;t in the hashtable, you&rsquo;ll get an error.</p><h4>2.3<tt>&nbsp;</tt><a name="(part._.Updating_.Values)"></a>Updating Values</h4><p>What if we want to update the value associated with a key? We use an
assignment statement as follows:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">hashtable[key] = new_value</span></p></td></tr></table></p><p>So, to change the number of seats in CIT368 to 70, we&rsquo;d write</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">room_capacity["CIT368"] = 70</span></p></td></tr></table></p><h4>2.4<tt>&nbsp;</tt><a name="(part._.Adding_.New_.Keys)"></a>Adding New Keys</h4><p>To add a new key (and its value) to a hashtable, we use the same
notation as for updating a value, just with an unused key:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">room_capacity["CIT506"] = 25</span></p></td></tr></table></p><h4>2.5<tt>&nbsp;</tt><a name="(part._.Removing_.Keys)"></a>Removing Keys</h4><p>To remove a key (and its value) from the hashtable, we write</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">del hashtable[key]</span></p></td></tr></table></p><p>So, we can take "CIT506" out of the hashtable using</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">del room_capacity["CIT506"]</span></p></td></tr></table></p><p>If the key isn&rsquo;t in the hashtable, you&rsquo;ll get an error.</p><h4>2.6<tt>&nbsp;</tt><a name="(part._.Checking_whether_a_key_is_in_the_table)"></a>Checking whether a key is in the table</h4><p>To ask whether a particular key is in the hashtable we reuse the
<span style="font-style: italic">in</span> notation that we have seen elsewhere in Python:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">"Sayles" in room_capacity</span></p></td></tr></table></p><p>As elsewhere, this returns a Boolean.</p><h4>2.7<tt>&nbsp;</tt><a name="(part._.Iterating_over_key-value_pairs)"></a>Iterating over key-value pairs</h4><p>What if we wanted to find all of the rooms with at least 50 seats? How
do we search all the pairs, building up a list of keys whose value
meet a criteria?</p><p>We use a for-loop:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">my_rooms = []</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"># the room variable takes on each key in the hashtable</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">for room in room_capacity:</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">if room_capacity[room] &gt; 50:</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">my_rooms.append(room)</span></p></td></tr></table></p><p>Note here that this is linear.  Hashtables reduce lookup of values
based on keys to constant, but some computations still require looking
at all the "rows" of the table (as it were).</p><h4>2.8<tt>&nbsp;</tt><a name="(part._.Hashtables_with_more_complicated_values)"></a>Hashtables with more complicated values</h4><p>If we&rsquo;re going to frequently look for rooms with certain capacities,
we might want to organize our data differently, so that a number range
maps to a list of room names.  Here&rsquo;s our original table written in
that fashion:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"># hashtable mapping seat ranges to classrooms</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">capacities = {"45-65": ["CIT368", "FRDMN101"],</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"65-100: [],"</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"150-200": ["BERT130"]}</span></p></td></tr></table></p><p>Remember that a hashtable can only have one value for each key. So
when we have multiple values for the same key, we have to put them in
some datastructure that we in turn store in the hashtable.  Here, we
put a list of room names under each range key.</p><p>Wouldn&rsquo;t it be nice to leave the ranges as numbers instead of strings?
For example, don&rsquo;t we want a table like:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Low</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">High</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Rooms</span></p></td></tr><tr><td><p><span class="stt">45</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">65</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"CIT368", "FRDMN101"</span></p></td></tr><tr><td><p><span class="stt">65</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">100</span></p></td></tr><tr><td><p><span class="stt">150</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">200</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">"BERT130"</span></p></td></tr></table></p><p>This doesn&rsquo;t have the form of a hashtable that we showed at the start
of the lecture.  There can be only one key column.  Our version
creates a key from the first two columns by making a string out of
them. We could have also made a dataclass for this. We&rsquo;ll see more
about using dataclasses as keys in the next lecture.</p><h4>2.9<tt>&nbsp;</tt><a name="(part._.Wrapup)"></a>Wrapup</h4><p>This is pretty much what you need to know to program with
hashtables. There&rsquo;s one last detail around using classes as keys,
which we will cover next time.  And of course, we still need to show
how all of this works under the hood.</p><h3>3<tt>&nbsp;</tt><a name="(part._.Converting_code_from_lists_to_hashtables)"></a>Converting code from lists to hashtables</h3><p>We practiced these operations by trying to convert a version of our
banking code that maintained a list of accounts to one that maintained
a hashtable of accounts.  This code file shows both the original list
version and the hashtable version.</p><h3>4<tt>&nbsp;</tt><a name="(part._.The_global_annotation)"></a>The global annotation</h3><p>We spent a bit of time understanding the <span class="stt">global</span> annotation and
how it works.  To keep the notes cleaner, we&rsquo;ll provide those notes in
a separate file.</p></div></div><div id="contextindicator">&nbsp;</div></body></html>